---
import Layout from '../../layouts/Layout.astro';
import { getLangFromUrl, useTranslations } from '../../i18n/translations';
import CTA from '../../components/CTA.astro';
import BreadcrumbSchema from '../../components/BreadcrumbSchema.astro';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const prefix = lang === 'sk' ? '' : '/en';
const base = import.meta.env.BASE_URL.replace(/\/$/, '');

const breadcrumbs = [
  { name: 'Domov', url: '/' },
  { name: 'Blog', url: '/blog/' }
];

const posts = [
  {
    slug: 'specialne-pripady-intrastat',
    title: 'Špeciálne prípady v Intrastat hláseniach',
    excerpt: 'Spracovanie tovaru, vrátenie, náhrada, rozložené zásielky, software a predaj na diaľku - naučte sa správne vykazovať tieto špeciálne prípady.',
    date: '2025-11-10',
    readTime: '10 min',
    category: 'Pokročilé',
    image: `${base}/images/blog-specialne-pripady.jpg`,
  },
  {
    slug: 'trojstranný-obchod',
    title: 'Trojstranný obchod a nepriamy dovoz/vývoz',
    excerpt: 'Komplexný sprievodca trojstranným obchodom a nepriamym dovozom/vývozom. Naučte sa správne vykazovať zložité obchodné operácie.',
    date: '2025-09-15',
    readTime: '9 min',
    category: 'Pokročilé',
    image: `${base}/images/blog-trojstranný-obchod.jpg`,
  },
  {
    slug: 'colny-sadzobnik-zatriedenie',
    title: 'Colný sadzobník a zatriedenie tovaru',
    excerpt: 'Komplexný sprievodca colným sadzobníkom a správnym zatriedením tovaru. Naučte sa ako priradiť správny kód KN a vyhnúť sa častým chybám.',
    date: '2025-07-20',
    readTime: '8 min',
    category: 'Praktický návod',
    image: `${base}/images/blog-colny-sadzobnik.jpg`,
  },
  {
    slug: 'co-je-intrastat',
    title: 'Čo je Intrastat a kedy vzniká povinnosť?',
    excerpt: 'Komplexný sprievodca systémom Intrastat pre slovenské firmy. Zistite, kedy vám vzniká povinnosť podávať hlásenia a čo všetko potrebujete vedieť.',
    date: '2025-01-15',
    readTime: '5 min',
    category: 'Základy',
    image: `${base}/images/blog-co-je-intrastat.jpg`,
  },
  {
    slug: 'prahy-oslobodenia-2025',
    title: 'Prahy oslobodenia pre rok 2025',
    excerpt: 'Aktuálne prahy oslobodenia pre Intrastat hlásenia v roku 2025. Čo sa zmenilo a ako to ovplyvní vašu firmu.',
    date: '2025-03-10',
    readTime: '3 min',
    category: 'Legislatíva',
    image: `${base}/images/blog-prahy-oslobodenia.jpg`,
  },
  {
    slug: 'najcastejsie-chyby',
    title: '5 najčastejších chýb pri Intrastat hláseniach',
    excerpt: 'Vyhnite sa týmto častým chybám pri podávaní Intrastat hlásení. Praktické tipy od odborníkov.',
    date: '2025-05-05',
    readTime: '4 min',
    category: 'Tipy',
    image: `${base}/images/blog-najcastejsie-chyby.jpg`,
  },
];

function formatDate(dateString: string) {
  const date = new Date(dateString);
  return date.toLocaleDateString('sk-SK', {
    day: 'numeric',
    month: 'long',
    year: 'numeric',
  });
}
---

<Layout title={`${t('nav.blog')} | Intrastat Portál`} description="Novinky a užitočné informácie zo sveta Intrastat. Tipy, legislatívne zmeny a praktické rady.">
  <BreadcrumbSchema items={breadcrumbs} />
  
  <!-- Page Header -->
  <section class="bg-gradient-to-br from-primary-600 to-primary-800 py-16 md:py-20">
    <div class="container-custom">
      <div class="max-w-3xl">
        <h1 class="text-4xl md:text-5xl font-bold text-white mb-4">
          {t('blog.title')}
        </h1>
        <p class="text-xl text-primary-100">
          {t('blog.subtitle')}
        </p>
      </div>
    </div>
  </section>

  <!-- Blog Posts -->
  <section class="section-padding">
    <div class="container-custom">
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
        {posts.map((post) => (
          <article class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden hover:shadow-lg transition-shadow">
            <img 
              src={post.image} 
              alt={post.title}
              class="h-48 w-full object-cover"
              loading="lazy"
            />
            <div class="p-6">
              <div class="flex items-center gap-3 mb-3">
                <span class="text-xs font-medium text-primary-600 bg-primary-50 px-2 py-1 rounded">
                  {post.category}
                </span>
                <span class="text-xs text-slate-500">{post.readTime} čítania</span>
              </div>
              <h2 class="text-xl font-bold text-slate-900 mb-2 hover:text-primary-600 transition-colors">
                <a href={`${prefix}/blog/${post.slug}`}>{post.title}</a>
              </h2>
              <p class="text-slate-600 text-sm mb-4 line-clamp-3">
                {post.excerpt}
              </p>
              <div class="flex items-center justify-between">
                <time class="text-xs text-slate-500">{formatDate(post.date)}</time>
                <a 
                  href={`${prefix}/blog/${post.slug}`}
                  class="text-sm font-medium text-primary-600 hover:text-primary-700 inline-flex items-center gap-1"
                >
                  {t('blog.readMore')}
                  <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
                  </svg>
                </a>
              </div>
            </div>
          </article>
        ))}
      </div>
    </div>
  </section>
</Layout>
